<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Portal UI and Code Customization • shinyExprPortal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Portal UI and Code Customization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinyExprPortal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/shinyExprPortal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/config.html">Full Configuration Guide</a></li>
    <li><a class="dropdown-item" href="../articles/customization.html">Portal UI and Code Customization</a></li>
    <li><a class="dropdown-item" href="../articles/dataprep.html">Data Preparation Guide</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/C4TB/shinyExprPortal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Portal UI and Code Customization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/C4TB/shinyExprPortal/blob/main/vignettes/customization.Rmd" class="external-link"><code>vignettes/customization.Rmd</code></a></small>
      <div class="d-none name"><code>customization.Rmd</code></div>
    </div>

    
    
<p>This article describes how to customize certain visual aspects using
the configuration file and how to extend the portal with custom
modules.</p>
<div class="section level2">
<h2 id="customizing-the-portal-ui">Customizing the portal UI<a class="anchor" aria-label="anchor" href="#customizing-the-portal-ui"></a>
</h2>
<p>There are two ways to customize the interface of a deployed portal:
global settings and module-specific settings.</p>
<div class="section level3">
<h3 id="global-customizations">Global customizations<a class="anchor" aria-label="anchor" href="#global-customizations"></a>
</h3>
<p>In the current version, you can add an acronym or logo, change the
title of the tab in the browser, add an icon-based shortcut menu to the
landing page and modify the <a href="https://bootswatch.com" class="external-link">Bootswatch</a> theme.</p>
<p>The configuration file should look like the following:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> PROJ</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">logo</span><span class="kw">:</span><span class="at"> logo.png</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">windowtitle</span><span class="kw">:</span><span class="at"> MyProject analysis portal</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">iconMenu</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="kw">-</span><span class="at"> moduleName</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="kw">-</span><span class="at"> moduleName2</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">bootswatch</span><span class="kw">:</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="at"> </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> theme_name</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="at"> </span><span class="fu">version</span><span class="kw">:</span><span class="at"> 3, 4 or 5</span></span></code></pre></div>
<p>For the logo and the icon menu, you should create a folder named
<strong>www</strong> in your project’s folder and place the
corresponding images inside, so the resulting file tree looks like
this:</p>
<pre><code>project/
├─about.md
├─app.R
├─config.yaml
├─...
└─www/
  ├─logo.png
  └─...</code></pre>
<p>The icon menu enables using a screenshot of a module to highlight
results and provide a shortcut to it. A PNG file named for each module
should be created and placed inside the www folder and the names of the
modules should be listed under iconMenu in the configuration file, as
shown above.</p>
<p>Regarding the themes, the current version of the package will work
well with most light-based themes. Not every theme was tested so it’s
recommended that you test different themes until you find one that works
well for your project.</p>
</div>
<div class="section level3">
<h3 id="module-customization">Module customization<a class="anchor" aria-label="anchor" href="#module-customization"></a>
</h3>
<p>Every module included in the package supports <code>title</code> and
<code>description</code> fields. The title is the entry on the menu,
whereas the description field is the text that appears between the menu
and the content of the module. The description should be used to
instruct visitors about how to use the module and also describe some
aspects of that module if needed. For example, it could include a link
to an external resource or references.</p>
<p>Besides these two fields, most modules include some degree of
customization of colors:</p>
<p><strong>compareTrajGroups</strong>: a list of HTML-compatible colors
for the points for each different value of trajectory_category
(e.g. time points).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">compareTrajGroups</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="at">  </span><span class="fu">custom_traj_colors</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"#ff0000"</span><span class="kw">,</span><span class="at"> </span><span class="st">"#ff00ff"</span><span class="kw">,</span><span class="at"> </span><span class="st">"#0000ff"</span><span class="kw">]</span></span></code></pre></div>
<p><strong>degDetails</strong>: a list of HTML-compatible colors for
non-significant, logFC-only significant, p-value-only significant and
logFC and p-value significant genes in the volcano plot</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">degDetails</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="at">  </span><span class="fu">custom_point_colors</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"black"</span><span class="kw">,</span><span class="at"> </span><span class="st">"yellow"</span><span class="kw">,</span><span class="at"> </span><span class="st">"red"</span><span class="kw">,</span><span class="at"> </span><span class="st">"blue"</span><span class="kw">]</span></span></code></pre></div>
<p><strong>geneModulesHeatmap</strong>: colors (discrete or for
interpolation) or RColorBrewer palettes for the variables that can be
used in annotations for the heatmaps and a RColorBrewer palette for the
heatmap colors.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">geneModulesHeatmap</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="at">  </span><span class="fu">custom_annotation_colors</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="at">    </span><span class="fu">NumericVar1</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"red"</span><span class="kw">,</span><span class="at"> </span><span class="st">"blue"</span><span class="kw">]</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="at">    </span><span class="fu">NumericVar2</span><span class="kw">:</span><span class="at"> </span><span class="st">"RdBu"</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="at">    </span><span class="fu">DiscreteVar1</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"yellow"</span><span class="kw">,</span><span class="at"> </span><span class="st">"green"</span><span class="kw">,</span><span class="at"> </span><span class="st">"blue"</span><span class="kw">]</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="at">  </span><span class="fu">custom_heatmap_palette</span><span class="kw">:</span><span class="at"> </span><span class="st">"BrBG"</span></span></code></pre></div>
<p><strong>multiMeasureCorr</strong>: RColorBrewer palete for heatmap
colors.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">multiMeasureCorr</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="at">  </span><span class="fu">custom_heatmap_palette</span><span class="kw">:</span><span class="at"> </span><span class="st">"BrBG"</span></span></code></pre></div>
<p><strong>singleGeneCorr</strong>: list of colors for categorical
variables in scatterplot.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">singleGeneCorr</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="at">  </span><span class="fu">custom_point_colors</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="at">    </span><span class="fu">SubjectVar1</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"red"</span><span class="kw">,</span><span class="at"> </span><span class="st">"blue"</span><span class="kw">]</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="at">    </span><span class="fu">SubjectVar2</span><span class="kw">:</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="at">      </span><span class="fu">Value1</span><span class="kw">:</span><span class="at"> </span><span class="st">"red"</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="at">      </span><span class="fu">Value2</span><span class="kw">:</span><span class="at"> </span><span class="st">"blue"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="using-custom-modules">Using custom modules<a class="anchor" aria-label="anchor" href="#using-custom-modules"></a>
</h2>
<p>The package also supports the inclusion of new external models,
without requiring any changes to the source code of the package. The
feature is primarily aimed at supporting features that may have a more
niche use case or experimenting with new ideas. Any new code should be
implemented based on the following template, for a new
<code>moduleName</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moduleName_config</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">config</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Checking moduleName configuration"</span><span class="op">)</span></span>
<span>  <span class="co"># Add dependency names here</span></span>
<span>  <span class="va">requiredPackages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu">stopIfNotInstalled</span><span class="op">(</span><span class="va">requiredPackages</span>, <span class="st">"moduleName"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">config</span><span class="op">$</span><span class="va">required_variable</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"moduleName: </span></span>
<span><span class="st">         'required_variable' is missing"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">config</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mod_moduleName_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">module_name</span>, <span class="va">config</span>, <span class="va">module_config</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu">NS</span><span class="op">(</span><span class="va">module_name</span><span class="op">)</span></span>
<span>  <span class="va">title</span> <span class="op">&lt;-</span> <span class="va">module_config</span><span class="op">$</span><span class="va">title</span></span>
<span>  <span class="va">description</span> <span class="op">&lt;-</span> <span class="va">module_config</span><span class="op">$</span><span class="va">description</span></span>
<span>  </span>
<span>  <span class="va">required_variable</span> <span class="op">&lt;-</span> <span class="va">module_config</span><span class="op">$</span><span class="va">required_variables</span></span>
<span>  </span>
<span>  <span class="fu">tabPanel</span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="va">title</span> <span class="op">%||%</span> <span class="st">"Default title"</span>,</span>
<span>      value <span class="op">=</span> <span class="st">"moduleName"</span>,</span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">h5</span><span class="op">(</span><span class="va">description</span> <span class="op">%||%</span> <span class="st">"Default description"</span><span class="op">)</span>,</span>
<span>      <span class="fu">splitLayout</span><span class="op">(</span></span>
<span>        <span class="fu">verticalLayout</span><span class="op">(</span></span>
<span>          <span class="fu">wellPanel</span><span class="op">(</span></span>
<span>           <span class="co"># Inputs that use the ns object above</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu">verticalLayout</span><span class="op">(</span></span>
<span>          <span class="co"># Outputs</span></span>
<span>        <span class="op">)</span>,</span>
<span>        cellWidths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"20%"</span>, <span class="st">"80%"</span><span class="op">)</span>,</span>
<span>        cellArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"white-space: normal;"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mod_moduleName_server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">module_name</span>, <span class="va">config</span>, <span class="va">module_config</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">module_name</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">session</span><span class="op">$</span><span class="va">ns</span></span>
<span>    </span>
<span>    <span class="va">measures</span> <span class="op">&lt;-</span> <span class="va">config</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">measures</span></span>
<span>    <span class="va">expression_matrix</span> <span class="op">&lt;-</span> <span class="va">config</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">expression_matrix</span></span>
<span>    <span class="va">sample_lookup</span> <span class="op">&lt;-</span> <span class="va">config</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">sample_lookup</span></span>
<span>    <span class="va">subject_var</span> <span class="op">&lt;-</span> <span class="va">config</span><span class="op">$</span><span class="va">subject_variable</span></span>
<span>    <span class="va">sample_var</span> <span class="op">&lt;-</span> <span class="va">config</span><span class="op">$</span><span class="va">sample_variable</span></span>
<span></span>
<span>    <span class="va">required_variable</span> <span class="op">&lt;-</span> <span class="va">module_config</span><span class="op">$</span><span class="va">required_variable</span></span>
<span>    <span class="co"># Module code here</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span></code></pre></div>
<p><code>moduleName</code> can now be included in config.yaml file along
with required or optional properties. Note that the config function
above must be defined otherwise the new module will not be used,
although the property validation step is not needed. Each new module can
be placed in the main <code>app.R</code> or in its own <code>.R</code>
file. If the second option is used, then each R file must be sourced in
the <code>app.R</code>, e.g. <code>source("newCode.R")</code>.</p>
<blockquote>
<p><strong>Create the template in your code folder:</strong> the package
includes a function that will create a file with the above themplate.
After loading the package, run
<code>create_module_template("moduleName")</code> to create the file and
edit it.</p>
</blockquote>
<p>At deployment level, besides sourcing the moduleName file if
required, two other changes must be made in the app.R file: setting a
vector that contains the names of any new modules and passing that
variable as the <code>extra_modules</code> argument to
<code>run_app</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://c4tb.github.io/shinyExprPortal/">shinyExprPortal</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"newModule.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"anotherModule.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extra_modules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"newModule"</span>, <span class="st">"anotherModule"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_app.html">run_app</a></span><span class="op">(</span><span class="st">"config.yaml"</span>, extra_modules <span class="op">=</span> <span class="va">extra_modules</span><span class="op">)</span></span></code></pre></div>
<p>If you are unsure about how to implement a feature in a new module,
please post an issue on the package GitHub or check the source code for
the existing modules.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rafael Henkin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
