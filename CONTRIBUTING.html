<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Contributing to shinyExprPortal • shinyExprPortal</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Contributing to shinyExprPortal"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">shinyExprPortal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="articles/shinyExprPortal.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/config.html">Full Configuration Guide</a>
    <a class="dropdown-item" href="articles/customization.html">Portal UI and Code Customization</a>
    <a class="dropdown-item" href="articles/dataprep.html">Data Preparation Guide</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/C4TB/shinyExprPortal/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Contributing to shinyExprPortal</h1>
      <small class="dont-index">Source: <a href="https://github.com/C4TB/shinyExprPortal/blob/HEAD/.github/CONTRIBUTING.md" class="external-link"><code>.github/CONTRIBUTING.md</code></a></small>
    </div>

<div id="contributing-to-shinyexprportal" class="section level1">

<div class="section level2">
<h2 id="improvements">Improvements<a class="anchor" aria-label="anchor" href="#improvements"></a></h2>
<p>If you want to propose a small change to improve existing modules, please file an issue to go along with a pull request. To create a pull request, the following steps are useful:</p>
<ul><li>Fork and clone with <code>usethis::create_from_github("C4TB/shinyExprPortal", fork = TRUE)</code>
</li>
<li>Install all dependencies with <code>devtools::install_dev_deps()</code>
</li>
<li>Create a branch for the PR, e.g. <code>usethis::pr_init("what-is-changing")</code>
</li>
<li>Make changes and commit to your git, then run <code>usethis::pr_push</code> and wait for a review.</li>
</ul></div>
<div class="section level2">
<h2 id="new-modules">New modules<a class="anchor" aria-label="anchor" href="#new-modules"></a></h2>
<p>We are happy to support the addition of new modules to the package when appropriate. If you have an idea for a module, you can use the support for custom modules to develop and test it before proposing to include in the package. Once you have a module that you think has a good number of use cases and will be relevant for more users, please file an issue on the GitHub and we take it from there.</p>
<p>To start with a new module, you can run the function <code>create_module_template("module_name")</code> inside the R folder of the repository (after forking and cloning it). Then you should follow the two guides below: adding a new module and design and programming principles. The principles should be followed unless there is a good reason not to.</p>
</div>
<div class="section level2">
<h2 id="adding-a-new-module">Adding a new module<a class="anchor" aria-label="anchor" href="#adding-a-new-module"></a></h2>
<div class="section level3">
<h3 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a></h3>
<p>A module is always named with camelCase and, when finalised, should be included in the list of available modules in <code>inst/app-config.yml</code>. A module can require additional configuration settings or not, but to be included in an app, should have a value of TRUE in the configuration file, as follows:</p>
<pre><code>[more configuration above]
moduleName:
  TRUE
[more configuration below]</code></pre>
<p>The module will then consist of at least two files:</p>
<pre><code><span><span class="va">mod_moduleName.R</span>  </span>
<span><span class="va">mod_moduleName_config.R</span></span></code></pre>
<p>The first file contains three functions: <code>mod_moduleName_ui</code>, <code>mod_moduleName_tab</code> and <code>mod_moduleName_server</code>. The second file should have a function called <code>mod_moduleName_config</code>, which receives <code>config</code> as argument. If, as above, the module does not require any configuration, the function will look as follows:</p>
<pre><code><span><span class="va">moduleNameConfig</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">config</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Checking moduleName configuration"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">config</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>Otherwise, the function should return a transformed config object</p>
<pre><code><span><span class="va">moduleNameConfig</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">config</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Checking moduleName configuration"</span><span class="op">)</span></span>
<span>  <span class="va">config</span><span class="op">$</span><span class="va">argument</span> <span class="op">&lt;-</span> <span class="fu">doSomethingWith</span><span class="op">(</span><span class="va">config</span><span class="op">$</span><span class="va">argument</span><span class="op">)</span></span>
<span>  <span class="va">config</span></span>
<span><span class="op">}</span></span></code></pre>
<p>If required, any module-exclusive plotting or data functions can be included in a <code>mod_*_utils.R</code> file. The primary aim of the file is to reduce the amount of code in the main module file; but if any of the functions could potentially be used in more files, they should go in the general <code>utils_*.R</code> files. In the same way, if an author wants to use a function that exists in an existing <code>mod_*_utils.R</code> file in a more general way, they can rewrite it and transfer it to a <code>utils_*.R</code> file.</p>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h3>
<p>The <code>run_module</code> function allows testing a newly developed module in isolation from the rest of the application (which enables using <code><a href="https://rdrr.io/r/base/browser.html" class="external-link">browser()</a></code>, for example, or react logs). Before this is possible, you need to add the module name to the available_modules list in <code>inst/app-config.yml</code>, as mentioned above, and set up a .yaml configuration test file appropriately. This configuration file should be as similar as possible to a final configuration file, in terms of the data-related properties, and the new module configuration. Then you can modify the function call in the end of the script <code>dev/run_module.R</code>, with <code>configuration.yaml</code> also located in <code>dev</code>:</p>
<pre><code><span><span class="co"># Run the application</span></span>
<span><span class="fu">run_module</span><span class="op">(</span>module_name <span class="op">=</span> <span class="st">"newModule"</span>,</span>
<span>           config_file <span class="op">=</span> <span class="st">"configuration.yaml"</span><span class="op">)</span></span></code></pre>
<p>You can pass a data_folder argument to this function, e.g. <code>data_folder = "../testProject"</code>, if you want to keep data files and the configuration file on a separate folder.</p>
</div>
<div class="section level3">
<h3 id="documenting-and-deploying">Documenting and deploying<a class="anchor" aria-label="anchor" href="#documenting-and-deploying"></a></h3>
<p>The last step is the creation of a guide for configuring and using the new module. For that, you should modify the corresponding vignette (config.Rmd) and add an entry for the new module using the template from the other modules documented there.</p>
</div>
</div>
<div class="section level2">
<h2 id="design-and-programming-principles">Design and programming principles<a class="anchor" aria-label="anchor" href="#design-and-programming-principles"></a></h2>
<p>This section describes the principles guiding the design of the modules of shinyExprPortal. The aim is to establish the development boundaries (i.e. how much computation should be done within the app) and general readability vs. performance decisions. This should help to design and implement new modules.</p>
<div class="section level3">
<h3 id="id_1-prioritizing-base-r">1 Prioritizing base R<a class="anchor" aria-label="anchor" href="#id_1-prioritizing-base-r"></a></h3>
<p>The app, as it is, already imports a relatively high number of packages, and the aim is to avoid including new dependencies as much as possible for maintenance and customization reasons. It is better to preserve a cohesive app, modifying internal functions as required to support new functionality, rather than have modules with similar computations that rely on different packages.</p>
<p>The second reason is performance. It is tempting to use packages that include wrappers and convenience functions, e.g. to compute correlation and p-values simultaneously. With large expression matrices, it is probably better to use base R in most cases.</p>
</div>
<div class="section level3">
<h3 id="id_2-reactives-vs-functions">2 Reactives vs functions<a class="anchor" aria-label="anchor" href="#id_2-reactives-vs-functions"></a></h3>
<p>The priority when writing a module is to separate reactive selections from the computations. The code inside reactive blocks will only serve to evaluate the required inputs and pass the arguments to functions. Example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>computedData <span class="ot">&lt;-</span> <span class="fu">eventReactive</span>(input<span class="sc">$</span>compute_button, { </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req</span>(input<span class="sc">$</span>slider_value)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">myFilterFunction</span>(expression_matrix, input<span class="sc">$</span>slider_value)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({ </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">plotBarChart</span>(<span class="fu">computedData</span>())</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-on-functions">3 On functions<a class="anchor" aria-label="anchor" href="#id_3-on-functions"></a></h3>
<p><strong>Split and combine functions as needed:</strong> If a plot or function result is similar to another, it is a good idea to combine them in a single function with varying parameters. At the same time, it’s also a good idea to reduce a function to a bare minimum across modules, and have additional functions to complement it. Example: the basic scatterplot with a bit of customization as the base function, with faceting and fiting lines in separate functions.</p>
<p><strong>Placement:</strong> It is also better to leave module-specific functions in a module-specific file. In the future they can be moved to generic files if used across modules.</p>
<p><strong>Naming:</strong> Most of the internal functions will not be exported, so it’s preferable to give longer but descriptive names such as selectGenesIfTrue, instead of a generic name such as “filter”.</p>
</div>
<div class="section level3">
<h3 id="id_4-analysis-results-vs-exploration-trade-offs">4 Analysis results vs exploration trade-offs<a class="anchor" aria-label="anchor" href="#id_4-analysis-results-vs-exploration-trade-offs"></a></h3>
<p>The app enables visual exploration of data as well as results of the analysis, but it is not an actual analysis tool to do, e.g. clustering or differential expression analysis. Any results that require additional, non-standard packages (e.g. limma) should be computed separately and results included in files. Potential exceptions are those when file sizes are significantly higher than the computation time.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rafael Henkin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

